send:
  name: Send Message
  description: Send an SMS message to a contact.
  fields:
    contact_id:
      name: Contact
      description: Select a contact to send message to.
      required: true
      example: "contact_1"
      selector:
        entity:
          domain: sensor
          device_class: ""
          filter:
            - domain: sensor
              integration: textnow
    message:
      name: Message
      description: Message text to send.
      required: true
      example: "Hello, this is a test message"
      selector:
        text:

prompt:
  name: Prompt
  description: Send a prompt message with choices and wait for a reply. The reply will be parsed and a textnow_reply_parsed event will be fired.
  fields:
    contact_id:
      name: Contact
      description: Select a contact to send prompt to.
      required: true
      example: "contact_1"
      selector:
        entity:
          domain: sensor
          device_class: ""
          filter:
            - domain: sensor
              integration: textnow
    key:
      name: Key
      description: Unique key to identify this prompt. Used in reply_parsed event.
      required: true
      example: "user_choice"
      selector:
        text:
    prompt:
      name: Prompt Text
      description: The prompt message to send (options will be numbered automatically).
      required: true
      example: "Please choose an option"
      selector:
        text:
          multiline: true
    ttl_seconds:
      name: TTL Seconds
      description: Time to live for pending expectation in seconds. Leave empty to use default (300 seconds).
      required: true
      default: 300
      example: 300
      selector:
        number:
          min: 1
          max: 86400
          step: 1
          unit_of_measurement: seconds
    options:
      name: Options
      description: List of options for the user to choose from (as list or newline-separated string). Required.
      required: true
      example: "Option 1\nOption 2\nOption 3"
      selector:
        text:
    response_variable:
      name: Response Variable
      description: Variable name to store the response (e.g., "user_choice"). Use the textnow.wait_for_reply service after this prompt to wait for and capture the response. Leave empty to not store response.
      required: true
      default: ""
      example: "user_choice"
      selector:
        text:
    keep_pending:
      name: Keep Pending
      description: If true, don't clear pending expectation after first match. Set to false to clear after first reply.
      required: true
      default: false
      selector:
        boolean:

clear_pending:
  name: Clear Pending
  description: Clear pending expectations for a contact.
  fields:
    contact_id:
      name: Contact
      description: Select a contact to clear pending for.
      required: true
      example: "contact_1"
      selector:
        entity:
          domain: sensor
          device_class: ""
          filter:
            - domain: sensor
              integration: textnow
    key:
      name: Key
      description: Optional specific key to clear. If not provided, clears all pending for the phone.
      example: "user_choice"
      selector:
        text:

set_context:
  name: Set Context
  description: Set or merge context data for a contact.
  fields:
    contact_id:
      name: Contact
      description: Select a contact to set context for.
      required: true
      example: "contact_1"
      selector:
        entity:
          domain: sensor
          device_class: ""
          filter:
            - domain: sensor
              integration: textnow
    data:
      name: Data
      description: Dictionary of context data to merge.
      required: true
      example: '{"step": 1, "user_name": "John"}'
      selector:
        object:

wait_for_reply:
  name: Wait for Reply
  description: Helper service to validate pending expectations. The actual waiting must be done using 'wait_for_trigger' in your automation. After calling textnow.prompt, use wait_for_trigger to wait for the textnow_reply_parsed event, then use the 'variables' action to set your variable from trigger.event.data.response_number.
  fields:
    contact_id:
      name: Contact
      description: Select the contact that should reply.
      required: true
      example: "contact_1"
      selector:
        entity:
          domain: sensor
          device_class: ""
          filter:
            - domain: sensor
              integration: textnow
    key:
      name: Key
      description: The key that was used in the prompt service call.
      required: true
      example: "user_choice"
      selector:
        text:
    response_variable:
      name: Response Variable
      description: Variable name to store the response (e.g., "user_choice"). The response will be stored as the selected option number (1, 2, 3, etc.) in this automation variable.
      required: true
      example: "user_choice"
      selector:
        text:
    timeout:
      name: Timeout
      description: Maximum time to wait for reply in seconds. Leave empty to use the TTL from the prompt.
      required: false
      example: 300
      selector:
        number:
          min: 1
          max: 86400
          step: 1
          unit_of_measurement: seconds

